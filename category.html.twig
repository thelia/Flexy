{%  extends 'base.html.twig' %}
{% set page = app.request.get('page')|default(1) %}
{% block title %}Catégorie
{% endblock %}

{% block body %}
	{% set products = resources('/api/front/products', {'productCategories.category.id': attr('category', 'id'), itemsPerPage:9, page: page}) %}
	{% set totalProducts = resources('/api/front/products', {'productCategories.category.id': attr('category', 'id'), itemsPerPage:9, page: page}) %}

	{% include '@components/Layout/Subheader/Category/SubheaderCategory.twig' with {title: attr('category', 'title'), description: attr('category', 'description'), nbProducts: products|length}  %}

	<section class="px-6 lg:px-[120px] py-6 lg:flex lg:gap-[115px] lg:justify-between">
		<div class="w-[310px] lg:block hidden mt-[44px] sticky top-20">
			<div class="h4 mb-[22px]">Filtrer</div>

			{% set sizes %}
			{% set sizesData = [
        { value: 1, label: 'S - 34/36' },
        { value: 2, label: 'M - 38/40', disabled: true },
        { value: 3, label: 'L - 42/44' }
      ] %}

			{% include '@components/Organisms/Modules/Filters/FilterClassic.twig' with {options: sizesData, name: 'size', id: 'filterSize'} %}
			{% endset %}

			{% set colors %}
			{% set colorsData = [
        { value: 1, color: '#6969B3', label: 'State Blue' },
        { value: 2, color: '#FFB698', label: 'Vermillon' },
        { value: 3, color: '#767676', label: 'Grey' },
        { value: 4, color: '#84DCC6', label: 'Tiffany Blue', disabled: true },
        { value: 5, color: '#DD6E42', label: 'Sienna' },
        { value: 6, color: '#C17767', label: 'Old Rose' },
      ] %}

			{% include '@components/Organisms/Modules/Filters/FilterColor.twig' with {options: colorsData, name: 'color', id: 'filterColor'} %}
			{% endset %}

			<div>
				{% include '@components/Molecules/Accordion/Accordion.twig' with {
          title: "Taille",
          content: sizes
        } %}

				{% include '@components/Molecules/Accordion/Accordion.twig' with {
          title: "Couleur",
          content: colors
				} %}
			</div>
		</div>

		<div>
			<div class="lg:justify-between lg:items-center mb-[29px] hidden lg:flex">
				<span>{{products|length}}
					article(s)</span>

				<div class="w-[250px]">
					{% include '@components/Molecules/Fields/FieldSelect/FieldSelect.twig' with {
          label: "Trier par",
          tooltip: "Trier les produits",
          placeholder: "Trier par",
          options: [{
            value: "priceASC",
            label: "Prix croissant"
          }, {
            value: "priceDESC",
            label: "Prix décroissant"
          }, {
            value: "newness",
            label: "Nouveautés"
          }, {
            value: "promo",
            label: "Promotions"
          }],
        } %}
				</div>

			</div>

			<div class="grid grid-cols-2 lg:grid-cols-3 gap-4 lg:gap-8 mb-[40px]">
				{% for product in products %}
					{% include '@components/Organisms/ProductCard/ProductCard.twig' with  product|merge({displayWishButton: true}) %}
				{% endfor %}
			</div>

			<div class='mx-auto lg:mx-0 lg:ml-auto w-max'>
				{% include '@components/Molecules/Pagination/Pagination.twig' with {
        prevText: 'Précédent',
        nextText: 'Suivant',
        currentPage: page,
        totalPages: 3
      } %}
			</div>

			<p class="paragraph-4 lg:paragraph-2 lg:pt-[56px] lg:pb-[96px] max-w-[664px] pt-[102px] pb-[52px] mx-auto">
				{{ attr('category', 'description') }}
			</p>
		</div>
	</section>

	{% include '@components/Layout/Reinsurance/Reinsurance.twig' with { data: [
      {
        strongText: 'Livraison gratuite',
        text: 'Pour toute commande supérieure à 100€',
        linkLabel: 'Voir conditions',
        link: '#',
        icon: 'reinsurance-delivery'
      },
      {
        strongText: 'Paiement sécurisé',
        text: 'Carte bancaire, Paypal',
        linkLabel: 'Voir conditions',
        link: '#',
        icon: 'reinsurance-payment'
      },
      {
        strongText: 'Satisfait ou remboursé',
        text: 'Echange ou remboursement offert sous 30 jours',
        linkLabel: 'Voir conditions',
        link: '#',
        icon: 'reinsurance-satisfied'
      }
    ] } %}
{% endblock %}
